@using System.Security.Claims;
@{
    var actionName = "";
    if (ViewContext.RouteData.Values["Action"].ToString() != null)
    {
        actionName = ViewContext.RouteData.Values["Action"].ToString();
    }

    // Retrieve claim values
    var surname = User.FindFirstValue(ClaimTypes.Surname);
    var name = User.FindFirstValue(ClaimTypes.Name);
    var role = User.FindFirstValue(ClaimTypes.Role);
    var initial = $"{name?.FirstOrDefault()}{surname?.FirstOrDefault()}";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"]</title>
    <link href="~/lib/bootstrap/dist/css/bootstrap.css" rel="stylesheet" />
    <link href="~/css/main.css" rel="stylesheet" />
    <link href="~/css/style.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/font/inter.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/FaultSubsystem.styles.css" asp-append-version="true" />
    <style>
        /* Style for the logout icon */
        .logout-icon {
            margin-left: 10px; /* Adjust spacing between the initials and the logout icon */
            color: #007bff; /* Change the color to match your theme */
            cursor: pointer;
            font-size: 1.25rem; /* Size of the exit icon */
            transition: color 0.3s ease;
        }

            .logout-icon:hover {
                color: #dc3545; /* Change color when hovered */
            }

        /* Tooltip styles */
        .tooltip-inner {
            background-color: #343a40; /* Tooltip background color */
            color: #fff; /* Tooltip text color */
        }

        .tooltip-arrow {
            border-top-color: #343a40; /* Arrow color */
        }
    </style>
    @if (ViewContext.RouteData.Values["Action"].ToString() == "Login" || ViewContext.RouteData.Values["Action"].ToString() == "CreateAccount") // Check if the current action is Login
    {
        <link rel="stylesheet" href="~/css/loginStyles.css" /> <!-- Login-specific stylesheet -->
    }
</head>
<body>
    @if (!(actionName == "Login" || actionName == "CreateAccount"))  // This will hide the banner on the login page
    {
        <header class="top-bar">
            <div class="logo-section">
                <img src="~/images/ChillTech Logo.jpg" alt="Logo" class="logo">
                @if (role == null)
                {
                    <script type="text/javascript">
                        window.location.href = '@Url.Action("Login", "Account")';
                    </script>
                }
                else
                {
                    <a href="@Url.Action("Dashboard", role.Replace(" ", ""))" class="home-link">Home</a>
                }
            </div>
            <div class="user-info">
                <span class="user-name">@surname, @name (@role)</span>

                <!-- User initials, clickable -->
                <div class="user-icon" onclick="toggleDropdown()">
                    @initial
                </div>

                <!-- Exit icon with tooltip for logout -->
                <form asp-action="Logout" asp-controller="Account" method="post" style="border: none; background: transparent; padding: 0; cursor: pointer;">
                    <button type="submit" class="logout-icon" data-toggle="tooltip" title="Logout">
                        <img src="~/icons/box-arrow-right.svg" alt="Logout" class="logout-icon-svg" />
                    </button>
                </form>
            </div>
        </header>
    }

    <main class="content">
        @RenderBody()
    </main>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>

    <script>
        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>